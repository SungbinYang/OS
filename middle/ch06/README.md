> 이 포스트는 [감자님 강의](https://www.inflearn.com/course/%EB%B9%84%EC%A0%84%EA%B3%B5%EC%9E%90-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/dashboard '인프런 강의')를 기반으로 작성되었습니다.

## 메모리 종류

컴퓨터에는 여러 종류의 메모리가 있다. 이번 포스트에서 왜 컴퓨터에 여러 종류의 메모리가 필요한지 서로 무엇이 다른지 알아보자.

위의 그림은 컴퓨터에서 사용되는 메모리들이다. 아래로 갈수록 가격은 싸지고 용량은 커지지만 속도는 느려진다. 먼저 레지스터부터 알아보자. 레지스터는 가장 빠른 기억장소로 CPU내에 존재한다. 컴퓨터의 전원이 꺼지면 데이터가 사라지기 때문에 휘발성 메모리라고 부른다. CPU를 구분할 때 32bit, 64bit를 많이 들어봤을 것이다. 여기서 32bit와 64bit는 레지스터의 크기를 말한다. 32bit 레지스터를 가지고 있으면 32bit CPU라고 말하고 반대로 64bit 레지스터를 가지고 있으면 64bit CPU라고 말한다. CPU는 계산할 때 메인 메모리에 있는 값을 레지스터로 가져와 계산한다. 계산 결과는 다시 메인 메모리에 저장시킨다. 예시를 보자.

```
movl $5, -4(%rbp)
movl $7, -8(%rbp)
movl -4(%rbp), %edx
movl -8(%rbp), %eax
addl %edx, %eax
movl %eax, -12(%rbp)
nop
addq $48, %rsp
popq %rbp
ret
```

위의 코드는 이전 포스트에서 컴파일을 할 때 생성된 어셈블리 코드 일부이다. 어셈블리 코드를 보는 이유는 기계어로 1:1 매칭이 되기 때문에 실제로 레지스터를 사용하는 것을 볼 수 있기 때문이다. 여기서 왼쪽에 있는 것은 명령어이고 오른쪽은 데이터를 의미한다. 정확히 무슨 일을 하는지 알 수 없지만 이렇게 레지스터를 가지고 무언가를 처리한다. 그럼 레지스터가 무엇인지 알아보았으니 우리 프로그램이 실제로 올라갈 메인 메모리를 살펴보자. 레지스터와 메인 메모리 사이에 캐시라는 휘발성 메모리가 있다. 먼저 캐시부터 살펴보자. 레지스터는 CPU가 사용하는 메모리로 굉장히 빠르다. 그에 비해 메인 메모리는 너무 느리다. 메인 메모리에 있는 값을 레지스터로 옮기려면 한참 걸리기 때문에 필요할 것 같은 데이터를 미리 가져오기로 한다. 미리 가져완 데이터를 저장하는 곳이 캐시이다. 캐시는 성능의 이유로 여러 개 둔다. 만약 CPU가 값을 요청하여 레지스터로 값을 옮겨야 한다면 단계에 따라 가장 속도가 바른 L1 캐시를 확인하고 없다면 L2 캐시를 확인하고 없다면 L3 캐시를 확인하는데 여기도 없을 때 메인 메모리로 값을 가져온다. 이제 제일 중요한 메인 메모리에 대해 살펴보자. 메인 메모리는 실제 운영체제와 다른 프로세스들이 올라가는 공간이다. 전원이 공급되지 않으면 데이터가 지워지기 때문에 휘발성 메모리다. HDD나 SSD보다 속도는 빠르지만 가격이 비싸기 때문에 데이터를 저장하기보다는 실행 중인 프로그램만 올린다. 이제 보조저장장치인 SSD와 HDD에 대해 알아보자. 컴퓨터는 사무용 프로그램, 게임, 작업한 파일을 저장할 필요가 있다. 이전에 살펴본 메모리들은 휘발성 메모리고 가격이 비싸서 저장하기 어려웠다. 그래서 가격이 저렴하고 전원이 공급되지 않아도 데이터가 지워지지 않는 비휘발성 메모리를 만들었다. 요즘 HDD 가격을 보면 테라 단위가 몇만 원밖에 안 한다. HDD의 용량을 메인 메모리로 확보하려면 엄청난 비용이 들 것이다. 메인 메모리가 이렇게 비싼데 캐시와 레지스터를 1TB를 만들려면 일반인들은 컴퓨터를 사용할 수 없을 것이다. 현재 우리는 레지스터와 캐시, 메인 메모리, HDD를 이용하여 가격과 속도를 절충해주는 구조 덕분에 저렴하고 빠른 컴퓨터를 사용할 수 있다.
